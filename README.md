# 基于机器学习的南京地区特定天气及气象要素精准预报研究

## 项目概述与背景

本项目基于美国国家海洋和大气管理局（NOAA）提供的南京禄口站52年连续历史气象数据（1973-2024年），运用现代机器学习技术对南京地区的特定天气现象和关键气象要素进行精准预报研究。

随着全球气候变化的加剧和极端天气事件的频发，准确的天气预报对于城市规划、交通运输、农业生产、公共安全等领域具有重要意义。传统的数值天气预报模型虽然在大尺度天气系统预报方面表现良好，但在局地特定天气现象（如雾、降水等）的精准预报方面仍存在挑战。

本研究通过深入挖掘长时间序列气象数据中的潜在规律和特征，构建基于机器学习的智能预报模型，旨在提高南京地区特定天气现象的预报精度，为区域气象服务和决策支持提供科学依据。

## 数据集信息

### 数据来源
- **数据提供方**：美国国家海洋和大气管理局（NOAA）国家环境信息中心（NCEI）
- **数据集名称**：全球每日气象数据摘要（Global Summary of the Day - GSOD）
- **观测站点**：南京禄口站（站点编号：58238099999）
- **数据获取链接**：[NCEI 全球每日摘要数据搜索平台](https://www.ncei.noaa.gov/access/search/data-search/global-summary-of-the-day?stations=58238099999)

### 数据特征
- **时间跨度**：1973年1月1日 - 2024年12月31日（52年连续数据）
- **数据规模**：18,957条日观测记录
- **原始参数**：共13个核心气象参数

### 包含参数详情

| **参数代码** | **参数名称** | **含义** | **单位** |
|-------------|-------------|----------|----------|
| TEMP | 平均温度 | 当天的平均气温 | 华氏度 (°F) |
| MAX | 最高温度 | 当天的最高气温 | 华氏度 (°F) |
| MIN | 最低温度 | 当天的最低气温 | 华氏度 (°F) |
| DEWP | 平均露点 | 当天的平均露点温度 | 华氏度 (°F) |
| SLP | 海平面气压 | 换算到海平面的当天平均大气压力 | 毫巴 (mb) |
| WDSP | 平均风速 | 当天的平均风速 | 节 (knots) |
| MXSPD | 最大持续风速 | 当天记录到的最高持续风速 | 节 (knots) |
| PRCP | 降水量 | 当天总的液态降水量 | 英寸 (inches) |
| SNDP | 积雪深度 | 当天测量的地面积雪深度 | 英寸 (inches) |
| VISIB | 平均能见度 | 当天的平均水平能见距离 | 英里 (miles) |
| FRSHTT | 天气现象指示器 | 6位二进制标志，记录雾、雨、雪、雹、雷、龙卷风等天气现象 | 二进制标志 |

#### FRSHTT数据类型说明
| **缩写 (Abbreviation)** | **全称 (Full Name)** | **含义 (Meaning)**                                           | **单位 (Unit)** |
| ----------------------- | -------------------- | ------------------------------------------------------------ | --------------- |
| TEMP                    | 平均温度             | 当天的平均气温。                                             | 华氏度 (°F)     |
| DEWP               | 平均露点 | 当天的平均露点温度。露点是空气在恒定气压下冷却至水蒸气饱和并凝结成液态水（露水）的温度 | 华氏度 (°F)     |
| SLP                     | 平均海平面气压       | 换算到海平面的当天平均大气压力。             | 毫巴 (mb)       |
| STP                     | 平均测站气压         | 在测站海拔高度上测得的当天平均大气压力。     | 毫巴 (mb)       |
| VISIB                   | 平均能见度           | 当天的平均水平能见距离。                                     | 英里 (miles)    |
| WDSP                    | 平均风速             | 当天的平均风速。                                             | 节 (knots)      |
| MXSPD                   | 最大持续风速         | 当天记录到的最高持续风速。                                   | 节 (knots)      |
| GUST                    | 最大阵风             | 当天记录到的最高阵风速度。                                   | 节 (knots)      |
| MAX                     | 最高温度             | 当天的最高气温。                                             | 华氏度 (°F)     |
| MIN                     | 最低温度             | 当天的最低气温。                                             | 华氏度 (°F)     |
| PRCP                    | 降水量               | 当天总的液态降水量（例如雨水）。                             | 英寸 (inches)   |
| SNDP                    | 雪深                 | 当天测量的地面积雪深度。                                     | 英寸 (inches)   |
| FRSHTT                  | 天气现象指标         | 6位二进制标志 (1=是, 0=否/未报告)，按顺序分别代表当天是否发生了以下天气现象：雾 (Fog)、小雨或毛毛雨 (Rain or Drizzle)、雪或冰粒 (Snow or Ice Pellets)、冰雹 (Hail)、雷 (Thunder)、龙卷风/漏斗云 (Tornado/Funnel Cloud)。 | 二进制标志      |

**注意:**

- 数据中的缺失值通常用一系列的 `9` 来表示 (例如 `9999.9`, `999.9`)，具体的数值和小数点位置会根据不同的数据字段有所不同。
- 所有数据均基于格林尼治标准时间 (GMT) 进行报告和汇总。
- 详细信息请参考 NOAA 官方的 `readme.txt` 文件。

**数据质量说明**：
- 缺失值采用特定代码标识（如9999.9、999.9、99.99等）
- 所有数据基于格林尼治标准时间（GMT）记录
- 经过严格的质量控制和标准化处理

## 核心研究问题

本项目聚焦于两个核心的天气预报问题：

### 1. 研究问题一：关键天气现象的发生概率预测（分类任务）
- **预测目标**：雾的发生概率
- **问题类型**：二分类问题（有雾/无雾）
- **应用价值**：为交通运输、航空安全、城市管理提供雾霾预警
- **技术挑战**：类别不平衡问题处理、特征工程优化

### 2. 研究问题二：日总降水量的量化预报（回归任务）
- **预测目标**：日降水量的精确数值
- **问题类型**：回归预测问题
- **应用价值**：为农业灌溉、城市排水、防洪减灾提供定量参考
- **技术挑战**：极值预测、时间序列特征提取

## 项目结构

```
.
├── data/                                    # 数据文件夹
│   └── nanjing_weather_1973_2024.csv      # 南京气象数据集
├── notebooks/                              # Jupyter Notebook 分析文件
│   ├── weather_prediction_analysis.ipynb  # 主要分析和建模文件
│   └── 代码报告.pdf                        # 代码执行报告
├── requirements.in                         # 高层依赖定义文件
├── requirements.txt                        # 锁定版本依赖文件
├── LICENSE                                 # MIT 开源许可证
├── .gitignore                             # Git 忽略文件配置
├── .gitattributes                         # Git 属性配置
├── 机器学习.pptx                          # 项目演示文稿
└── README.md                              # 项目说明文档
```

## 安装与环境设置

### 系统要求

- **Python 版本**：本项目在 **Python 3.9** 环境下开发和测试。为确保所有依赖项兼容，建议使用相同版本的Python。
- **操作系统**：支持 Windows、macOS、Linux
- **内存要求**：建议至少 8GB RAM（用于处理大规模时间序列数据和深度学习模型训练）

### 环境配置步骤

#### 1. 创建并激活虚拟环境（强烈建议）

使用 conda 创建虚拟环境：
```bash
conda create -n weather_env python=3.9
conda activate weather_env
```

或使用 venv 创建虚拟环境：
```bash
python -m venv weather_env
# Windows
weather_env\Scripts\activate
# macOS/Linux
source weather_env/bin/activate
```

#### 2. 安装项目依赖

本项目使用 `pip-tools` 管理依赖。`requirements.in` 文件定义了项目的高层依赖，`requirements.txt` 是自动生成的锁定版本文件。

**步骤 2.1：安装 pip-tools**
```bash
pip install pip-tools
```

**步骤 2.2：同步环境依赖**
```bash
pip-sync requirements.txt
```

这将安装 `requirements.txt` 中指定的所有包及其精确版本。

#### 3. 验证安装

验证关键库是否正确安装：
```bash
python -c "import pandas, numpy, sklearn, tensorflow, matplotlib, seaborn; print('所有依赖库安装成功！')"
```

### 依赖管理说明

#### requirements.in（高层依赖）
```
imbalanced_learn    # 处理类别不平衡问题
matplotlib          # 数据可视化
numpy              # 数值计算
pandas             # 数据处理
scikit_learn       # 机器学习算法
seaborn            # 统计可视化
tensorflow_intel   # 深度学习框架（Intel优化版）
```

#### 主要依赖库版本
- **pandas**: 2.3.0 - 数据处理和分析
- **numpy**: 2.0.2 - 数值计算基础
- **scikit-learn**: 1.6.1 - 机器学习算法库
- **tensorflow-intel**: 2.18.0 - 深度学习框架
- **matplotlib**: 3.9.4 - 数据可视化
- **seaborn**: 0.13.2 - 统计图表
- **imbalanced-learn**: 0.12.4 - 处理不平衡数据集

#### 可选：更新依赖

如果您修改了 `requirements.in` 文件，可以运行以下命令重新生成 `requirements.txt`：
```bash
pip-compile requirements.in
```

## 如何运行

### 启动 Jupyter Notebook

1. **确保虚拟环境已激活**：
   ```bash
   conda activate weather_env  # 或相应的激活命令
   ```

2. **启动 Jupyter Notebook**：
   ```bash
   jupyter notebook
   ```

3. **打开分析文件**：
   在浏览器中打开 `notebooks/weather_prediction_analysis.ipynb`

### 运行分析流程

项目的主要分析流程包括：

1. **数据导入与预处理**
   - 加载南京气象数据集
   - 处理缺失值和异常值
   - 数据类型转换和标准化

2. **探索性数据分析（EDA）**
   - 数据基本统计信息
   - 时间序列趋势分析
   - 特征相关性分析
   - 天气现象分布统计

3. **特征工程**
   - 基础气象特征提取
   - 时间序列滞后特征
   - 滑动窗口统计特征
   - 周期性时间特征

4. **模型构建与训练**
   - 雾预测分类模型
   - 降水量回归预测模型
   - 模型性能评估与优化

5. **结果分析与可视化**
   - 模型性能指标分析
   - 预测结果可视化
   - 特征重要性分析

### 注意事项

- **数据文件路径**：确保 `data/nanjing_weather_1973_2024.csv` 文件存在
- **运行时间**：完整运行可能需要 30-60 分钟，取决于硬件配置
- **内存使用**：深度学习模型训练时可能占用较多内存
- **GPU 支持**：如有 NVIDIA GPU，TensorFlow 将自动使用 GPU 加速

## 预期成果

### 主要研究成果

#### 1. 天气现象预测模型
- **雾预测分类器**：基于多种机器学习算法（随机森林、梯度提升、神经网络等）构建的雾发生概率预测模型
- **模型性能**：通过交叉验证和时间序列验证评估模型准确性、精确率、召回率等指标
- **特征重要性分析**：识别影响雾形成的关键气象因子

#### 2. 降水量定量预报模型
- **回归预测器**：构建精确的日降水量预测模型
- **预测精度**：评估模型的均方根误差（RMSE）、平均绝对误差（MAE）和决定系数（R²）
- **极值预测能力**：特别关注强降水事件的预测准确性

#### 3. 特征工程创新
- **时间序列特征**：开发适用于气象数据的滞后特征和滑动窗口特征
- **周期性特征**：提取季节性和年际变化特征
- **复合特征**：构建露点差、日温差等物理意义明确的派生特征

#### 4. 数据挖掘洞察
- **长期气候趋势**：分析52年气象数据中的气候变化趋势
- **季节性规律**：揭示南京地区天气现象的季节性分布特征
- **极端事件分析**：识别和分析历史极端天气事件的特征

### 应用价值

#### 科学研究价值
- 为区域气象学研究提供数据驱动的分析方法
- 验证机器学习在气象预报中的应用潜力
- 为气候变化研究提供长时间序列分析案例

#### 实际应用前景
- **交通运输**：雾预警系统，提高道路和航空安全
- **农业生产**：精准降水预报，指导灌溉和田间管理
- **城市管理**：极端天气预警，支持应急响应决策
- **公共服务**：为市民提供更准确的天气预报信息

#### 技术贡献
- 展示了传统统计方法与现代机器学习技术的结合
- 提供了处理长时间序列气象数据的完整工作流程
- 为类似的区域气象预报研究提供了可复制的技术框架

### 项目特色

1. **数据质量高**：基于52年连续的高质量观测数据
2. **方法全面**：涵盖传统机器学习和深度学习方法
3. **问题导向**：聚焦实际应用需求的具体预报问题
4. **可重现性强**：提供完整的代码和详细的文档说明

---

## 许可证

本项目采用 MIT 许可证。详情请参阅 [LICENSE](LICENSE) 文件。

## 贡献指南

欢迎对本项目提出建议和改进！请通过以下方式参与：

1. 提交 Issue 报告问题或建议
2. Fork 项目并提交 Pull Request
3. 改进文档和代码注释
4. 分享使用经验和应用案例

## 联系信息

如有任何问题或建议，请通过以下方式联系：

- **项目作者**：Liu Chang
- **邮箱**：liuc@mail.ecust.edu.cn
- **项目类型**：机器学习工具与平台课程设计
- **开发时间**：2025年

---

*本项目为学术研究项目，旨在探索机器学习在气象预报中的应用，为相关领域的研究和实践提供参考。*
